var expect = require('chai').expect;
require('mocha-sinon');

// removed .value and showSuccess/showError
function checkPassword(input) {
    /**
     * Password Requirement: Between 8 to 10 characters which contain at least one lowercase letter, 
     * one uppercase letter, one numeric digit, and one special character
     */
    var re = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,10}$/;
    if (input.trim() !== '' && re.test(input.trim())){
        console.log('Password is valid');
    } else if (input.trim() === '') {
        console.log('Password is empty');
    } else {
        console.log('Password is invalid');
    }
}

describe('login.js - checkPassword()', function() {
    beforeEach(function() {
        this.sinon.stub(console, 'log');
    });

    it('should check for empty input', function() {
        checkPassword("");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Password is empty')).to.be.true;
    });

    it ('should check small input size', function() {
        checkPassword("hi");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Password is invalid')).to.be.true;
    });

    it ('should check large input size', function() {
        checkPassword("blahblahblah");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Password is invalid')).to.be.true;
    });

    it ('should check for typical valid input', function() {
        checkPassword("passw0rd");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Password is invalid')).to.be.true;
    });
});

// removed .value and showSuccess/showError
function checkEmail(input) {
    const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    // const re = /^\S+@\S+$/;
    if (input.trim() !== '' && re.test(input.trim())) {
        console.log('Email is valid');
    } else if (input.trim() === '') {
        console.log('Email is empty');
    } else {
        console.log('Email is invalid');
    }
}

describe('login.js - checkEmail()', function() {
    beforeEach(function() {
        this.sinon.stub(console, 'log');
    });

    it('should check for empty input', function() {
        checkEmail("");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Email is empty')).to.be.true;
    });

    it('should check for large input size', function() {
        checkEmail("djangoreallyreallyreallyreallysucks@gmail.com");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Email is valid')).to.be.true;
    });

    it ('should check for invalid input - no user', function() {
        checkEmail("@gmail.com");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Email is invalid')).to.be.true;
    });

    it ('should check for invalid input - no domain', function() {
        checkEmail("hellothere@");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Email is invalid')).to.be.true;
    });

    it ('should check for invalid input - no @ symbol', function() {
        checkEmail("hellotheregmail.com");
        expect(console.log.calledOnce).to.be.true;
        expect(console.log.calledWith('Email is invalid')).to.be.true;
    });
});